{% extends 'base.html' %} 
{% block content %}
{% load static %}

<meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <script src="//code.jquery.com/jquery.min.js"></script>
  <!-- <link rel="stylesheet" href="jquery.dropdown.css"> -->
  <script src="jquery.dropdown.js"></script>
  <!-- Include the plugin's CSS and JS: -->
  
  <script type="text/javascript" src="js/bootstrap-multiselect.js"></script>
  <link rel="stylesheet" href="css/bootstrap-multiselect.css" type="text/css"/>
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  
  <link rel="stylesheet" type="text" href="{% static '/bootstrap-5.1.3-dist/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" media="screen" href="{% static '/css/bootstrap.min.css' %}">
  
  <link href="{% static '/css/bootstrap-toggle.min.css' %}" rel="stylesheet">
  <script src="{% static '/js/bootstrap-toggle.min.js' %}"></script>
  
      <link rel="stylesheet" type="text/css" href="{% static '/css/select2.min.css' %}" />
      <link rel="stylesheet" type="text/css" media="screen" href="{% static '/css/select2.min.css' %}">
  <link rel="stylesheet" href="{% static '/css/jquery-ui.css' %}">
  
  
  <link rel="stylesheet" href="{% static '/css/font-awesome.min.css' %}">
  
  <script src="{% static 'js/timepicker.js' %}"></script>
  <!-- <link rel="stylesheet" type="text/css" href="{% static '/css/select2.min.css' %}" /> -->
  
    <script src="{% static '/js/jquery.min.js' %}"></script>
     <!-- Select2 CSS --> 
  
  <!-- jQuery --> <script src="{% static '/js/jquery.min4.js' %}"></script> 
  
  <!-- Select2 JS --> 
  <script src="{% static '/js/select2.min.js' %}"></script>
  <!-- Load icon library -->
  <link rel="stylesheet" href="{% static '/css/font-awesome.min.css' %}">
  <!-- multiple selesct marked officer -->
  
  <link href="css/jquery.multiselect.css" rel="stylesheet" type="text/css">
  <script src="{% static '/js/jquery.dataTables.min.js' %}"></script>
    <link href="{% static '/css/jquery.dataTables.min.css' %}"  rel="stylesheet"/>
    <!-- Sheets for datepicker for target date -->
    
    <link rel="stylesheet" href="{% static '/css/jquery-ui.css' %}">
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script src="{% static '/js/jquery-ui.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static '/css/quicksand.css' %} ">
    <link rel="stylesheet" type="text/css" hef="{% static '/css/lato.css' %}">
<br>

<style>
  * {
  box-sizing: border-box;
}
/* The Close Button */
.close {
  color: white;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
* {
  box-sizing: border-box;
}

/* Style the search field */
form.example input[type=text] {
  padding: 8px;
  font-size: 17px;
  border: 1px solid grey;
  float: left;
  width: 60%;
  background: #f1f1f1;
}

/* Style the submit button */
form.example button {
  float: left;
  width: 15%;
  padding: 8px;
  background: #2196F3;
  color: white;
  font-size: 17px;
  border: 1px solid grey;
  border-left: none; /* Prevent double borders */
  cursor: pointer;
}

form.example button:hover {
  background: #0b7dda;
}

/* Clear floats */
form.example::after {
  content: "";
  clear: both;
  display: table;
}        
</style>

<style>
 

.autocomplete {
  /*the container must be positioned relative:*/
  position: relative;
  display: inline-block;
}

.autocomplete-items {
  position: absolute;
  border: 1px solid #d4d4d4;
  border-bottom: none;
  border-top: none;
  z-index: 99;
  /*position the autocomplete items to be the same width as the container:*/
  top: 100%;
  left: 0;
  right: 0;
}
.autocomplete-items div {
  padding: 10px;
  cursor: pointer;
  background-color: #fff;
  border-bottom: 1px solid #d4d4d4;
}
.autocomplete-items div:hover {
  /*when hovering an item:*/
  background-color: #e9e9e9;
}
.autocomplete-active {
  /*when navigating through the items using the arrow keys:*/
  background-color: DodgerBlue !important;
  color: #ffffff;
}
</style>

<body>

  <div class="container">
    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success' %}
              <div class="alert alert-success">
                <strong>Alert!</strong>{{ message }}
              </div>
            {% elif message.tags == 'error' %}
              <div class="alert alert-danger">
                <strong>Alert!</strong>{{ message }}
              </div>
            {% elif message.tags == 'info' %}
              <div class="alert alert-info">
                <strong>Alert!</strong>{{ message }}
              </div>
            {% else %}
            
            {% endif %}
           
        
        {% endfor %}
    {% endif %}
  </div>

  <h3 align="center" ><u><b>Use Template </b></u></h3>
<form method="POST"> 
  {% csrf_token %}
  <br><br>
<div class="row" style="margin-left: 10em; margin-right: 10em;">
    <!-- <div class="row" id="row1" > -->
      <div class="col-md-2"  style="margin-left:2em ;">
          <label for="Zone" >Rly/Org</label><span style="color:red;font-weight:bold">*</span>
          <select class="form-control" id="zone" name="zone" class="custom-select" 
         required>
              <option value=""  selected disabled>select</option>
              {% for z in Zone %}
              <option value="{{z}}">{{z}}</option>
              {% endfor %}
  
          </select>
      </div>

      <div class="col-md-2">
        <label for="division">Division</label>
        <select class="form-control" id="division" name="division" class="custom-select" style="max-width:100%;"
        value="{{ins_detail.division}}" required>
    
                <option value="" selected>NA</option>
                {% for d in division %}
                <option value="{{d}}">{{d}}</option>
                {% endfor %}
    
            </select>
        
    </div>

    <div class="col-md-2">
      <label for="division">Department</label><span style="color:red;font-weight:bold">*</span>
      <select class="form-control" id="department" name="department" class="custom-select" style="max-width:100%;"
      value="{{ins_detail.department}}"      required>
    
              <option value="All" selected>N/A</option>
              {% for d in department %}
              <option value="{{d.department_name}}">{{d.department_name}}</option>
              {% endfor %}
    
          </select>
      
    </div>
    
    <div  class="col-md-2" >
      <label for="location" >Location</label><br>
      <div class="autocomplete">
        <input  id="location" autocomplete="off" maxlength="20"  style="height: 2em;" required class="form-control" type="text" class="form-control" value="{{ins_detail.location}}"/>
      
      </div>
      
  </div>
  
    <div class="col-md-2" >
      <label for="start" >Inspection Date<span style="color:red;font-weight:bold">*</span></label><br>
      <input type="text" autocomplete="off" onclick='setTitle()' name="txtDate2" id="txtDate2" required class="form-control" style="margin-top:0em ;height: 2em;"  value="{{ins_detail.inspected_on}}"   readonly requied>
    
    </div>



        
</div> 



  
  <div class="row" style="margin-left: 10em; margin-right: 10em;">
    <label for="start" >Title<span style="color:red;font-weight:bold">*</span></label>
    <textarea class="form-control" maxlength="150"   id="titleinsp"  name="titleinsp" ></textarea>
   
  </div> 


  <br>
  <br>
  <br>


          <div class="col-md-12"> 
          <table id="table1" class="table table-striped table-bordered center" style="width:90%; margin-left: 7em; margin-right: 7em; ">

            <thead>
              <b style="margin-left: 7em;">Add Ckecklist Observation </b><br><br>
                <tr>
                 <th style= "text-align: left; border-top: 1px solid black; border-bottom: 1px solid black;width: 10%;">Item No.</th>
                 <th style= "text-align: left; border-top: 1px solid black; border-bottom: 1px solid black;width: 15%;">Activities to be done</th>
                 <th style= "text-align: left; border-top: 1px solid black; border-bottom: 1px solid black;width: 40%;">Observation</th>
                 <th style= "text-align: left; border-top: 1px solid black; border-bottom: 1px solid black;width: 10%;">Search Officer</th>
                 <th style= "text-align: left; border-top: 1px solid black; border-bottom: 1px solid black;width: 10%;">Mark Officer</th>
                 <th style= "text-align: left; border-top: 1px solid black; border-bottom: 1px solid black;width: 15%;">Target Date</th>
               </tr>
          
            </thead>
            
            {%if ass != ' None' %}
            <tbody  id="addworkmech">
            {% for i in ass %}
            
           
            <tr>
              <td aria-readonly="true" readonly style="text-align: center; width: 10px; font-family:verdana;">{{forloop.counter}}</td>
               <!-- <td ><textarea readonly aria-readonly="true" style="width:100%; height:100%; font-family:verdana; ">{{ j }}</textarea></td> -->
               <td> 
                 <div class="autocomplete">
                  <textarea class="form-control" maxlength="200" id="activities{{forloop.counter}}"  name="activities_name" value="{{ i.activities }}" style="width:200px;" disabled>{{ i.activities }}</textarea> 
                   <!-- <input aria-readonly="true" readonly style="font-family:verdana;white-space:nowrap;;" type="text" id="work1{{forloop.counter}}"  name = "work1{{forloop.counter}}" class = "form-control" autocomplete = "off" style="width:900px;"  value="{{ j.activity }}" > -->
                 </div>    
               </td>
              
              
              {% comment %} <td><div class="autocomplete1"><textarea maxlength="500"  name="observation" id='observation{{forloop.counter}}' autocomplete1 = "off"  style="height:60px;" class="form-control"  required ></textarea></div></td> {% endcomment %}
              <td>
                <div>
                  
                  <input type="radio" onclick="name_hide()" name="observation{{forloop.counter}}" id='observation{{forloop.counter}}'  style="text-align: center; width: 10px; font-family:verdana;">&nbsp;&nbsp;
                  <label for="observation">Yes</label>&nbsp;&nbsp;&nbsp;
                 
                    <input type="radio" name="observation{{forloop.counter}}"  onclick="name_hide()" id='observation{{forloop.counter}}'  style="text-align: center; width: 10px; font-family:verdana;">&nbsp;&nbsp;
                    <label for="observation">No</label>&nbsp;&nbsp;&nbsp;

                    <input  type="radio" class="obser{{forloop.counter}}"  onclick="name_hide()" name="observation" id='observation{{forloop.counter}}'  style="text-align: center; width: 10px; font-family:verdana;">&nbsp;&nbsp;
                    <label for="observation">Other</label>&nbsp;&nbsp;
                
                    <textarea maxlength="500"  class="newtestc" style="margin-left:1vh;margin-top:1vh;"  name="observation" id='observation{{forloop.counter}}' autocomplete1 = "off"  style="height:60px;"  required  ></textarea>
                  {% comment %} <label for="html"> Type</label> {% endcomment %}
                  
                  

              </div>
              </td>
              <td><div class="autocomplete1"><button type="button" class="btn btn-primary btn-md" id='officer{{forloop.counter}}'  data-toggle="modal" data-target="#exampleModal" onclick="hidetable(this); setvalueIN()" style="margin-left:1vh;margin-top:1vh;">i</button>  </div></td>
              <td><input type="text" class="form-control" value="" custom-offic="" id='markeofficer{{forloop.counter}}' class="autocomplete1" readonly></td>
              <td><div class="autocomplete1"><input type="text"  name="date" class="form-control datepke" style="height:40px;" id='targetdate{{forloop.counter}}'    readonly requied> </div></td>
             

             </tr>

          {%endfor%}
          {% endif %}
          <input type="text" value="{{ass_count}}"  id='count_row' hidden>
        </tbody>
            
      </table>
      </div>
      <input type="hidden" value="0" id="s1" name="s1">

         
      <div>
      <!-- <button  type="button" name="addmech"onclick="changeColorBtn(this);" id="addmech" style="margin-left: 6em;" class="btn btn-primary btn-md">Add Item</button>
      <button  class="btn btn-danger btn-md" id="deletemech" >Delete</button>  -->
      
     
    </div> 
    <br>
    <br>
    
    <!-- <b style="margin-left: 2em;">Add Other Ckecklist Observation </b><br><br> -->
    <br>
  <div class="box-body no-padding" id ='search_checklist' style="margin-left: 7em; margin-right: 7em; display:none;">
      <br>
      <br>
    <div class="container">
      <textarea class="form-control"  maxlength="150"   id="note"  name="observation_notes" value="{{ i.activities }}"></textarea>
    </div>
  </div>

  <br>
  <br>

  <div class="col-sm-6" style="margin-left: 7em; margin-right: 7em;">
    <input type="checkbox" id="check"><b> You want Other Observation</b></legend>
  </div>

    <br>
    <br>
    <div class="box-body no-padding" id ='good_work' style="margin-left: 7em; margin-right: 7em; display:none;">
      <br>
      <div class="container">
        <textarea class="form-control" maxlength="150"   id="good"  name="observation_good" value="{{ i.activities }}" ></textarea>
      </div>
  </div>

  <br>
  <div class="col-sm-6" style="margin-left: 7em; margin-right: 7em;">
    <input type="checkbox" id="check_good"><b> You want to Add Good Work</b></legend>

  </div>
    <br>
    <br>
    
  <div class="box-body no-padding" id ='search_checklist_awards' style=" display:none;">
    <div class="container">
      <textarea class="form-control" maxlength="150"   id="award"  name="observation_award" value="{{ i.activities }}"></textarea>
    </div>

  </div>
  <br>
  <div class="col-sm-6" style="margin-left: 7em; margin-right: 7em;">
    <input type="checkbox" id="check_awards"><b> You want to Add Awards</b></legend>

  </div>
  <br>

 
    
    <br>
    <br>
    
    <button type="button" id="draft" name="draft" value="Save as draft" onclick="observation_data()" class="btn btn-success btn-md "
    style=" margin-left: 710px;">Save as Draft</button>  
    <button type="button" id="submit" name="submit" value="Submit"  class="btn btn-success btn-md" onclick="observation_submit()">Submit</button> 


</form>


<div class="modal" tabindex="-1" id="exampleModal" role="dialog" aria-labelledby="exampleModalLabel"
aria-hidden="true">
<div class="modal-dialog-modal-xl" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-title" id="exampleModalLabel"><b> Mark Officers</b></h4>
      <button type="button" class="close" data-dismiss="modal" id="close1" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
   
    <div class="modal-body">
      <form   action="" method="POST" >
        {% csrf_token %}
       <input type="text" value="" id="mark_officersss" hidden/>
      
  <div class="row">
      <div class="col-md-3">
          <label>Railway</label>
          <select class="form-control" id="rly_1" name="rly_1" class="custom-select" style="width: 150px;">

              <option value="All" selected>All</option>
              {% for i in Zone %}
              <option >{{i}}</option>
              {% endfor %}
  
          </select>
      </div>
      <div class="col-md-3">
          <label>Division</label>
          <select class="form-control" id="div_1" name="div_1" class="custom-select" style="width: 150px;">

              <option value="All" >All</option>
              {% for i in div %}
              <option>{{i.location_code}}</option>
              {% endfor %}
  
          </select>
      </div>
      <div class="col-md-3">
          <label>Department</label>
          <select class="form-control" id="dept_1" name="dept_1" class="custom-select" style="width: 150px;">

              <option value="All" selected>All</option>
              {% for i in department %}
              <option>{{i.department_name}}</option>
              {% endfor %}
  
          </select>
      </div>
      <div class="col-md-3">
          <label>Designation</label>
          <select class="form-control" id="desig" name="desig" class="custom-select" style="width: 150px;">

              <option value="All" selected>All</option>
             
  
          </select>
      </div>
  </div><br><br>
  <div class="row">
    <div class="col-md-3">
        <input type="checkbox"  id="myCheck" >
        <label>Show All Zonal Officers</label>
    </div>
    <div class="col-md-3">
        <input type="checkbox"  id="div_officers">
        <label>Show All Division Officers</label>
       
    </div>
    <div class="col-md-3">
      <input type="checkbox" name="chk" onclick="selects();">
      <label >Mark All Officers</label>
  </div>
  <div class="col-md-3">
      <input type="checkbox"  onclick="deSelect();">
      <label>Unmark</label>
     
  </div>
    
</div>
<br>
<div class="row">
    <div class="col-md-3">
        <input type="checkbox"  id="allgm" >
        <label>Select All GM</label>
    </div>
    <div class="col-md-3">
        <input type="checkbox"  id="alldrm">
        <label>Select All DRM</label>
       
    </div>
    <div class="col-md-3">
        <input type="checkbox"  id="allphod">
        <label>Select All PHOD</label>
       
    </div>
    <div class="col-md-3">
        <input type="checkbox"  id="allboard">
        <label>Select All Board Members</label>
       
    </div>
</div>
<br><br>
  <div class="row">
    <div class="col-md-6">
    <table id="text" class="table table-striped table-bordered ">
      <thead>
          <tr><th></th><th></th></tr>
      </thead>
      <tbody>
         
      </tbody>
  </table>
</div>
<div class="col-md-6">
<table id="text1" class="table table-striped table-bordered ">
  <thead>
      <tr><th></th><th></th></tr>
  </thead>
  <tbody>
     
  </tbody>
</table>
</div></div><br>
<div class="row">
<div class="col-md-6">
<table id="table2" class="table table-striped table-bordered ">
<thead>
  <tr><th></th><th></th></tr>
</thead>
<tbody>
 
</tbody>
</table>
</div>
<div class="col-md-6">
<table id="table3" class="table table-striped table-bordered ">
<thead>
<tr><th></th><th></th></tr>
</thead>
<tbody>

</tbody>
</table>
</div>
</div>
<div class="row">
<div class="col-md-6">
<table id="table4" class="table table-striped table-bordered ">
<thead>
<tr><th></th><th></th></tr>
</thead>
<tbody>

</tbody>
</table>
</div>
<div class="col-md-6">
<table id="table5" class="table table-striped table-bordered ">
<thead>
<tr><th></th><th></th></tr>
</thead>
<tbody>

</tbody>
</table>
</div>
</div> <input type="hidden" value="0" id="s1" name="s1">
  
 
  </form>
  </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      <button type="button" class="btn btn-primary" onclick="save_marked_officers();">Save changes</button>
    </div>
  </div>
</div>
</div>


      

<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel"
aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
  <div class="modal-header">
    <h4 class="modal-title"><b> Target Date</b></h4>
    
  </div>
 
    <div class="modal-body">
      
        
  
 
    
    <div><label for="start" >Target Date</label><br><input type="date"  class="col-md-2" required class="form-control" style="height: 2em;margin-top:0.7em;" id="target_date" value="new Date()"  onkeydown='event.preventDefault()' requied>
     
     
     </div>

  </div>
 
      
    </body>
    </div>
   
    </div>

</div>
</div>
</div>
    

  
     
<script>
  function backredirect(){
    document.location.href ="{% url 'created_checklist' %}"
  }

</script>  


<!-- 
<script>
  function observation_data(){
    let mydata=[]
    let count = $('#count_row').val()
    for(let x=1; x< parseInt(count); x++){
      let dict = {}
      let ob = 'observation'+x
      let obdata = $('#'+ob).val()
      dict['obser'] = obdata
      mydata.push(dict)
    }
    let obs_notes = $('#note').val()
    let obs_good = $('#good').val()
    let obs_award = $('#award').val()
    let obs_data = JSON.stringify(mydata)
    console.log(mydata)
    //console.log(obs_data)
    $.ajax({
      url: '#',
      dataType: 'json',
      type: 'POST',
      data: {obs_data, obs_good, obs_notes, obs_award},
      success: function(res){
        alert('data save')
      console.log(data)
        //console.log(res)
      }
    })
  }

</script> -->
  
<script>
  function observation_data(){
    let mydata=[]
    let count = $('#count_row').val()
    for(let x=1; x< parseInt(count); x++){
      let dict = {}
      let ob = 'observation'+x
      let obdata = $('#'+ob).val()
      dict['obser'] = obdata

      let ob1 = 'targetdate'+x
      let date = $('#'+ob1).val()
      dict['targetdate'] = date
      
      mydata.push(dict)
    }
    
    
    console.log($('#txtDate2').val())
    let data1 = {
      obs_data: JSON.stringify(mydata),
      date: JSON.stringify(mydata),
      obs_good:$('#good').val(),
      obs_notes:$('#note').val(),
      obs_award:$('#award').val(),
      

        zone:$("#zone").val(),
        division:$("#division").val(),
        location:$("#location").val(),
        department:$('#department').val(),
        inspection_date:$('#txtDate2').val(),
        titleinsp:$('#titleinsp').val(),
        btnValues:$('#draft').val(),

      csrfmiddlewaretoken: '{{ csrf_token }}'
    };
    $.ajax({
      url: '{% url "search_checklist_template_ajax" %}',
      dataType: 'json',
      type: 'POST',
      data: data1,
            //data: {obs_data, obs_good, obs_notes, obs_award},
      success: function(res){
        alert("Record Saved as Draft.");
        window.location.reload();
      console.log(res)
        //console.log(res)
      }
    })
  }

</script>

<script>
  
  function observation_submit(){
    let mydata=[]
    let count = $('#count_row').val()
    for(let x=1; x< parseInt(count); x++){
      let dict = {}
      let ob = 'observation'+x
      let obdata = $('#'+ob).val()
      dict['obser'] = obdata

      let ob1 = 'targetdate'+x
      let date = $('#'+ob1).val()
      dict['targetdate'] = date
      
      mydata.push(dict)
    }
    
    
    console.log($('#txtDate2').val())
    let data1 = {
      obs_data: JSON.stringify(mydata),
      date: JSON.stringify(mydata),
      obs_good:$('#good').val(),
      obs_notes:$('#note').val(),
      obs_award:$('#award').val(),
      

        zone:$("#zone").val(),
        division:$("#division").val(),
        location:$("#location").val(),
        department:$('#department').val(),
        inspection_date:$('#txtDate2').val(),
        titleinsp:$('#titleinsp').val(),
        btnValues:$('#submit').val(),

      csrfmiddlewaretoken: '{{ csrf_token }}'
    };
    $.ajax({
      url: '{% url "search_checklist_template_submit_ajax" %}',
      dataType: 'json',
      type: 'POST',
      data: data1,
            //data: {obs_data, obs_good, obs_notes, obs_award},
      success: function(res){
        alert("Record Saved as Finalized");
        window.location.reload();
      console.log(res)
        //console.log(res)
      }
    })
  }
    
</script>
{% comment %} set title ajax {% endcomment %}
<script>
 
function setTitle() {

  let zone = $('#zone').val()
  let division = $('#division').val()
  let department = $('#department').val()
  let txtDate = $('#txtDate2').val()
  let user = '{{desig}}'
  let title = 'Inspection of'
  //alert(zone+'----'+ user +'----'+department)

  
  var x = document.getElementById("location");
  x.value = x.value.toUpperCase();
  
  if(division == 'All'){
    $('#titleinsp').val(title+''+x.value+'  '+zone +' by '+user+' date: '+txtDate)
  }
  else{
    $('#titleinsp').val(title+' '+x.value+'  '+zone +'/'+division+' by '+user+' date: '+txtDate)
  }
  
}
</script>

<script>

  function name_hide(el){
    if (el.value=='Yes'){
      $(".newtestc").hide();
    }
    else if(el.value == 'No'){
      $(".newtestc").hide();
    }
    else{
      $(".newtestc").show();
    }

  }

  {% comment %} $(".obser").click(function(){
    //$(".newtestc").hide();
    var value = $(".obser").is(':checked');
    if(value){
      console.log("inside value")
      $(".newtestc").show();
    }
    else{
      console.log('inside else')
      $(".newtestc").hide();
    }
  }); {% endcomment %}
</script>


<script>

  $("#check").click(function(){
    var value = $("#check").is(':checked');
    if(value){
      console.log("inside value")
      $("#search_checklist").show();
    }
    else{
      console.log('inside else')
      $("#search_checklist").hide();
    }
  });
</script>
<script>

  $("#check_good").click(function(){
    var value = $("#check_good").is(':checked');
    if(value){
      console.log("inside value")
      $("#good_work").show();
    }
    else{
      console.log('inside else')
      $("#good_work").hide();
    }
  });
</script>
<script>

  $("#check_awards").click(function(){
    var value = $("#check_awards").is(':checked');
    if(value){
      console.log("inside value")
      $("#search_checklist_awards").show();
    }
    else{
      console.log('inside else')
      $("#search_checklist_awards").hide();
    }
  });
</script>

<script>

  $('#zone').change(function() {
    var rly=$('#zone').val();
  
        data={
            'rly':rly,
            
        }

          $.ajax({
            type : 'GET',
            url : "{% url 'checklist_locat_ajax' %}",
            dataType : 'json',
            data : data,

            success : function(response){
              division=response.division;
                          $('#division').empty();
                          //$('#division').append(`<option value="">N/A</option>`);
                          for (let i = 0; i < division.length; i++) {
                          $('#division').append(`<option value="${division[i]}">
                                              ${division[i]}
                                        </option>`);
                                      }
            }
          })
  })

</script>

<script>

  
function auto(inp, arr) {
  var currentFocus;
  inp.addEventListener("input", function(e) {
      var a, b, i, val = this.value;
      closeAllLists();
      if (!val) { return false;}
      currentFocus = -1;
      a = document.createElement("DIV");
      a.setAttribute("id", this.id + "autocomplete-list");
      a.setAttribute("class", "autocomplete-items");
    
      this.parentNode.appendChild(a);
   
      for (i = 0; i < arr.length; i++) {

        if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
          
          b = document.createElement("DIV");
       
          b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
          b.innerHTML += arr[i].substr(val.length);
        
          b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
       
              b.addEventListener("click", function(e) {
        
              inp.value = this.getElementsByTagName("input")[0].value;
              
              closeAllLists();
          });
          a.appendChild(b);
        }
      }
  });

  inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        
        currentFocus++;
        
        addActive(x);
      } else if (e.keyCode == 38) { 
      
        currentFocus--;
       
        addActive(x);
      } else if (e.keyCode == 13) {
     
        e.preventDefault();
        if (currentFocus > -1) {
        
          if (x) x[currentFocus].click();
        }
      }
  });
  function addActive(x) {
    if (!x) return false;
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
  
    x[currentFocus].classList.add("autocomplete-active");
  }
  function removeActive(x) {
   
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }
  function closeAllLists(elmnt) {
   
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
      x[i].parentNode.removeChild(x[i]);
    }
  }
}

document.addEventListener("click", function (e) {
    closeAllLists(e.target);
});
}

  $(document).ready(function(){
    var locarr = []
    $.ajax({
      url: '{% url "checklist_autoFetchLocation_ajax" %}',
      dataType: 'json',
      type: 'GET',
      success: function(res){
        for(i in res){
          locarr.push(res[i])
        }
        //console.log(res)
      }
    })
    auto(document.getElementById("location"), locarr);
  
  })
</script>

<script>

  $(document).ready(function() {
    $('#zone').select2();
    });

  $(document).ready(function() {
    $('#division').select2();
    });

  $(document).ready(function() {
    $('#department').select2();
    });

</script>


<script>


  $('#txtDate2').datepicker({
    dateFormat: 'dd-mm-yy',
    maxDate: 0
    
  })

  $('.datepke').datepicker({
    dateFormat: 'dd-mm-yy',
    minDate: 0
    
  })

</script>


<script>

      function selects(){  
          var ele=document.getElementsByName('chk');  
          for(var i=0; i<ele.length; i++){  
              if(ele[i].type=='checkbox')  
                  ele[i].checked=true;  
          }  
      }  
      function deSelect(){  
          var ele=document.getElementsByName('chk');  
          for(var i=0; i<ele.length; i++){  
              if(ele[i].type=='checkbox')  
                  ele[i].checked=false;  
                
          }  
      }       
    
</script>


      
<script>
  
  function hidetable(e){
    
   
    
    $('#text').show(); $('#text1').hide(); $('#table2').hide(); $('#table3').hide(); $('#table4').hide(); $('#table5').hide();
    $('#mark_officersss').val((e.id).substr(7));
  
  }
  
             $("#zone").select2();
            
                    // Read selected option
                    $('#rly').click(function(){
                      var username = $('#rly option:selected').text();
                      var userid = $('#rly').val();
                  
                     
                  
          
                    });
            $("#rly_1").select2();
            
            // Read selected option
            $('#rly_1').click(function(){
              var username = $('#rly_1 option:selected').text();
              var userid = $('#rly_1').val();
              
          
             
          
  
            });
            $("#div_1").select2();
            
            // Read selected option
            $('#div_1').click(function(){
              var username = $('#div_1 option:selected').text();
              var userid = $('#div_1').val();
          
             
          
  
            });
            $("#division").select2();
            
            $('#division').click(function(){
              var username = $('#div option:selected').text();
              var userid = $('#div').val();
          });
  
            $("#department").select2();
            
            $('#department').click(function(){
              var username = $('#department option:selected').text();
              var userid = $('#department').val();
          });
  
          $("#desig").select2();
            
            $('#desig').click(function(){
              var username = $('#desig option:selected').text();
              var userid = $('#desig').val();
          });
          $("#dept_1").select2();
            
            $('#dept_1').click(function(){
              var username = $('#desig option:selected').text();
              var userid = $('#desig').val();
          });
          </script>





{% comment %} mark officer satart new {% endcomment %}

<script>

function save_marked_officers(){


  

    var emp_no = ""
    var emp_no1 = ""
  
    $('.messageCheckbox:checkbox:checked').each(function(i){
      //val[i] = $(this).val();
      let oneOffic= $(this).val();
      //alert(oneOffic)
      
      let id = oneOffic.split(',')[0]
      let desig = oneOffic.split(',')[1]
      if(emp_no!="")emp_no+=',';
      emp_no +=id
      if(emp_no1!="")emp_no1+=',';
      emp_no1 +=desig
  
    });
    //alert(emp_no)
    //alert(emp_no1)
    
    let mark_off = $('#mark_officersss').val();
    
      markofficer='markeofficer'+ mark_off
      document.getElementById(markofficer).value=emp_no1;
      var myInput = document.getElementById(markofficer);
          myInput.setAttribute('custom-offic', emp_no);
      //alert(emp_no)
  
    $('#close1').click();   
}


$('#div_officers').click(function() {
  var table = $('#text1').DataTable();
  table.destroy();
  $('#text1').hide();
   var rly_1=$('#rly_1').val();
          // alert(rly_1);
   var div_1=$('#div_1').val();
          // alert(div_1);
    data={
        'rly_1':rly_1,
        'div_1':div_1,
        
    }
        
    if(this.checked){
          $.ajax({
              type: "GET",
              url: "{% url 'division_wise' %}",
              data: data, //--> send id of checked checkbox on other page
              success: function(response) {
               
                mydata=response.divwise;
                 let row = "";
                  let head = `<thead><tr><th></th>
                  <th>Division Officers</th></tr></thead>`;
                  
                 
                  for (let i = 0; i < mydata.length; i++) {
                      row += "<tr>";  
                        row+=  `<td><input type="checkbox" id="${mydata[i]['empno']}" class="messageCheckbox" value="${mydata[i]['empno']},${mydata[i]['desig_longdesc']}" name="chk" ></td>`;
                      row += `<td><input type="text" id="" name="comp_remarks" readonly style="background-Color:lightblue;" value="${mydata[i]['empname']}" ></td>`;
                      
                      row += `</tr>`;
                  }
                  
                  $('#text1 thead').remove();
                  $('#text1 tr').remove();
                  $('#text1').append(head);
                  $('#text1 tbody').append(row);
                  $('#text1').show();
                  $('#text1').DataTable();
                    
     
              },
         
          });

          }
  });   

  $('#allgm').click(function() {
    var table = $('#table2').DataTable();
    table.destroy();
    $('#table2').hide();
    var rly_1=$('#rly_1').val();
          // alert(rly_1);
    var div_1=$('#div_1').val();
    // alert(div_1);
    data={
        'rly_1':rly_1,
        'div_1':div_1,
        
    }
        
     if(this.checked){
        $.ajax({
              type: "GET",
              url: "{% url 'gm_list_officers' %}",
              data: data, //--> send id of checked checkbox on other page
              success: function(response) {
               
                  mydata=response.allgm;
                
                  for (let i = 0; i < mydata.length; i++){ 
                  
                    if (document.getElementById(mydata[i]['empno']).type=='checkbox'){
                  
                      document.getElementById(mydata[i]['empno']).checked=true;

                    }
                }  
             
              }, 
          });

      }
    });   

    
  $('#alldrm').click(function() {
        
      var table = $('#table3').DataTable();
      table.destroy();
      $('#table3').hide();
    
      var rly_1=$('#rly_1').val();
    
      var div_1=$('#div_1').val();
  
        data={
            'rly_1':rly_1,
            'div_1':div_1,
            
        }
            
     if(this.checked){
          $.ajax({
              type: "GET",
              url: "{% url 'drm_officers' %}",
              data: data, //--> send id of checked checkbox on other page
              success: function(response) {
               
                mydata=response.alldrm;
                for (let i = 0; i < mydata.length; i++){ 
          
                  if (document.getElementById(mydata[i]['empno']).type=='checkbox'){
                
                    document.getElementById(mydata[i]['empno']).checked=true;

                  }
             
       
                }  
                   
                 
                        
              },

          });

          }
    });   


  $('#allphod').click(function() {
     
    var table = $('#table4').DataTable();
    table.destroy();
    $('#table4').hide();
  
    var rly_1=$('#rly_1').val();
    
    var dept_1=$('#dept_1').val();
    
    data={
        'rly_1':rly_1,
        'dept_1':dept_1,
        
    }
        
     if(this.checked){
          $.ajax({
              type: "GET",
              url: "{% url 'phod_officers' %}",
              data: data, //--> send id of checked checkbox on other page
              success: function(response) {
               
                mydata=response.allphod;
                for (let i = 0; i < mydata.length; i++){ 
          
                  if (document.getElementById(mydata[i]['empno']).type=='checkbox'){
                
                    document.getElementById(mydata[i]['empno']).checked=true;

                  }

                }  
      
              },
              
             
          });

        }
  }); 

  $('#myCheck').click(function(){
    
 
    var table = $('#text').DataTable();
    table.destroy();
    $('#text').hide();
    
    var rly_1=$('#rly_1').val();
        
    data={
        'rly_1':rly_1,
        
      }
        
      if(this.checked){
          $.ajax({
              type: "GET",
              url: "{% url 'headqwise' %}",
              data: data,
              success: function(response) {
               
                mydata=response.hqwise;
                let row = "";
                let head = `<thead><tr><th></th>
                  <th>Zonal Officers</th></tr></thead>`;
                  
                 
                    for (let i = 0; i < mydata.length; i++) {
                        row += "<tr>";  
                        row+=  `<td><input type="checkbox" id="${mydata[i]['empno']}" class="messageCheckbox" value="${mydata[i]['empno']},${mydata[i]['desig_longdesc']}" name="chk"  ></td>`;
                        row += `<td><input type="text" id="" name="comp_remarks" readonly style="background-Color:lightblue;" value="${mydata[i]['empname']},${mydata[i]['desig_longdesc']}" ></td>`;
                        
                        row += `</tr>`;
                    }
                  
                  $('#text thead').remove();
                  $('#text tr').remove();
                  $('#text').append(head);
                  $('#text tbody').append(row);
                  $('#text').show();
                  $('#text').DataTable();       
                 
              },
              
             
          });

      }
  })
          

      

  $('#rly_1').change(function() {
  
  var rly_1=$('#rly_1').val();
  
  data={
      'rly_1':rly_1,
      
  }

  $.ajax({
    type : 'GET',
    url : "{% url 'division_by_rly1' %}",
    dataType : 'json',
    data : data,

    success : function(response){
      division=response.division;
      $('#div_1').empty();
      $('#div_1').append(`<option value="">All</option>`);
        for (let i = 0; i < division.length; i++) {
            $('#div_1').append(`<option value="${division[i]}">${division[i]}</option>`);
        }
                  
    }
    
  })
        
})  
</script>

  

{% endblock %}  